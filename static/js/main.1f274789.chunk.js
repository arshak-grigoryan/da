(this.webpackJsonpda=this.webpackJsonpda||[]).push([[0],{24:function(e,t,n){},32:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(18),o=n.n(a),i=(n(24),n(8)),c=n(4),s=n(1),u=n.n(s),l=n(3),d=n(11),p="AIzaSyAuVXgAR4aI47Fxg4ztfBpLpb_IafzKsMY",f=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],g={recommended:{file:"https://www.googleapis.com/auth/drive.file",install:"https://www.googleapis.com/auth/drive.install"}},h=[g.recommended.file,g.recommended.install].join(" "),v="openWithAppSpecificDocument",b="openWithGoogleWorkspaceDocument",m="newButton",k="/chooser",w="/editor?category=photos",x={getImageById:function(e){return gapi.client.drive.files.get({fileId:e,alt:"media",fields:"id, name"}).then(function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),n=t.headers["Content-Type"],r="data:".concat(n,";base64, ").concat(btoa(t.body)),e.abrupt("return",{src:r,mimeType:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.error(e)}))},getFileFields:function(e){var t=e.fileId,n=e.fields;return gapi.client.drive.files.get({fileId:t,fields:n}).then((function(e){return JSON.parse(e.body)})).catch((function(e){return console.error(e)}))},getAbout:function(e){return gapi.client.drive.about.get({fields:e}).then((function(e){return JSON.parse(e.body)})).catch((function(e){return console.error(e)}))},uploadFile:function(e){return fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id",{method:"POST",headers:new Headers({Authorization:"Bearer ".concat(gapi.auth.getToken().access_token)}),body:e}).then((function(e){return e.json()})).catch((function(e){console.error(e)}))},createFile:function(e){var t=e.resource,n=e.fields;return gapi.client.drive.files.create({resource:t,fields:n}).then((function(e){console.log(e);var t=JSON.parse(e.body);console.log(t);var n=JSON.parse(e.body).files;return console.log(n),n||t})).catch((function(e){return console.error(e)}))}},j=n(9),O=n(10),y=function(){function e(){Object(j.a)(this,e)}return Object(O.a)(e,[{key:"init",value:function(){var t=Object(l.a)(u.a.mark((function t(n,r){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("class"),console.log("initPicker"),t.next=4,e.handlePickerLoad();case 4:return console.log(this.isPickFile),t.next=7,e.createPicker(n,r);case 7:console.log("picker created");case 8:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()}],[{key:"handlePickerLoad",value:function(){return new Promise((function(e,t){gapi.load("picker",{callback:e,onerror:t})}))}},{key:"createPicker",value:function(){var t=Object(l.a)(u.a.mark((function t(n,r,a){var o,i,c,s,l;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log(n,r),o=gapi.auth.getToken().access_token,i=new google.picker.DocsView(google.picker.ViewId.FOLDERS).setLabel("My Drive").setOwnedByMe(!0).setIncludeFolders(!0).setSelectFolderEnabled(!0),c=new google.picker.DocsView(google.picker.ViewId.FOLDERS).setEnableDrives(!0).setIncludeFolders(!0).setSelectFolderEnabled(!0),s=new google.picker.DocsView(google.picker.ViewId.FOLDERS).setLabel("Shared with Me").setOwnedByMe(!1).setIncludeFolders(!0).setSelectFolderEnabled(!0),l=new google.picker.DocsView(google.picker.ViewId.FOLDERS).setLabel("Starred").setStarred(!0).setIncludeFolders(!0).setSelectFolderEnabled(!0),(new google.picker.PickerBuilder).addView(i).addView(c).addView(s).addView(l).setOAuthToken(o).setDeveloperKey(p).setCallback((function(t){return e.pickerCallback(t,n,r)})).enableFeature(google.picker.Feature.SUPPORT_DRIVES).setTitle("Pick a folder").build().setVisible(!0);case 8:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"pickerCallback",value:function(){var e=Object(l.a)(u.a.mark((function e(t,n,r){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),t[google.picker.Response.ACTION]===google.picker.Action.PICKED&&(a=t[google.picker.Response.DOCUMENTS][0],console.log(a),console.log(a.id));case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}(),I=new y;console.log(I);var S=new y;console.log(S);var F=function(e){return new Promise((function(t){var n=document.createElement("script");n.src=e,n.onload=function(){t()},document.body.appendChild(n)}))},D=new(function(){function e(){Object(j.a)(this,e),this.openWithState=null,this.newButtonState=null,this.driveActiveImageId=null,this.imgOptions=null}return Object(O.a)(e,[{key:"init",value:function(){var t=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("init check"),!window.gapi){t.next=3;break}return t.abrupt("return");case 3:return console.log("init"),t.prev=4,t.next=7,F("https://apis.google.com/js/api.js");case 7:return console.log("1"),t.next=10,e.loadClient();case 10:return console.log("2"),t.next=13,e.initClient();case 13:return console.log("3"),t.abrupt("return",gapi);case 17:t.prev=17,t.t0=t.catch(4),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[4,17]])})));return function(){return t.apply(this,arguments)}}()},{key:"signInWithGoogle",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.prev=2,e.next=5,gapi.auth2.getAuthInstance().signIn();case 5:return t=e.sent,e.abrupt("return",t);case 9:return e.prev=9,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"signOutGoogle",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:gapi.auth2.getAuthInstance().signOut();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"revokeAccess",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:gapi.auth2.getAuthInstance().disconnect();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shareDrive",value:function(){var t=Object(l.a)(u.a.mark((function t(n){var r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("shareDrive"),t.next=3,this.init();case 3:return t.next=5,e.loadDriveShare();case 5:return r=gapi.auth.getToken().access_token,t.next=8,new gapi.drive.share.ShareClient;case 8:(a=t.sent).setOAuthToken(r),a.setItemIds(this.driveActiveImageId),a.showSettingsDialog(),this.driveActiveImageId=null,n();case 14:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getGrantedScopes",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.abrupt("return",gapi.auth2.getAuthInstance().currentUser.get().getGrantedScopes());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"authUser",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a,o,i,c,s,l,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:if(console.log("userIdFromDrive",t),!(n=gapi.auth2.getAuthInstance()).isSignedIn.get()){e.next=23;break}if(r=n.currentUser.get().getGrantedScopes(),a=g.recommended,o=a.appdata,i=a.file,c=a.install,r.includes(o)&&r.includes(i)&&r.includes(c),console.log(r),!t){e.next=21;break}if(!A(n.currentUser.get().getId(),t)){e.next=14;break}return console.log("already signin from drive and existing are same!!",t),e.abrupt("return",t);case 14:this.openWithState=null,this.driveActiveImageId=null,console.log("isSameUser is false"),console.log("signOut"),n.signOut(),e.next=23;break;case 21:return console.log("userIdFromDrive is undefined"),e.abrupt("return",n.currentUser.get());case 23:if(U()){e.next=26;break}return e.abrupt("return");case 26:return e.next=28,this.signInWithGoogle();case 28:if(!(s=e.sent).error){e.next=34;break}return console.log("currentUser.error"),this.openWithState=null,this.driveActiveImageId=null,e.abrupt("return");case 34:if(!t){e.next=45;break}if(l=A(s.getId(),t),console.log("isSameUser",l),l){e.next=43;break}return n.disconnect(),(d=confirm("Drive account and choosed account doesn't match. Choose account again"))&&console.log("isUserAcceptedNewSigninFlow",d),alert("Your state was lost"),e.abrupt("return");case 43:return console.log("signin from drive first time"),e.abrupt("return",s);case 45:return console.log("signin independent first time"),e.abrupt("return",s);case 47:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"loadClient",value:function(){return new Promise((function(e,t){gapi.load("client:auth2",{callback:e,onerror:t})}))}},{key:"loadDriveShare",value:function(){return new Promise((function(e,t){gapi.load("drive-share",{callback:e,onerror:t})}))}},{key:"initClient",value:function(){return gapi.client.init({apiKey:p,clientId:"58948318321-knaasj1fie9mmvd715621ua0f7drspkd.apps.googleusercontent.com",discoveryDocs:f,scope:h})}}]),e}()),A=function(e,t){return e===t},C=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a,o,i,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.width,r=t.height,a=t.src,o=document.getElementById("myCanvas"),i=o.getContext("2d"),(c=new Image).src=a,c.onload=function(){o.width=n,o.height=r,i.drawImage(c,0,0)};case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,a,o,i,c,s,l,d,p,f,g,h,v,b;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.baseGroup,a=t.upscale,o=t.fileImgName,i=t.qualityValue,c=t.type,s=t.originalWidth,l=t.originalHeight,d=t.isPdf,p=t.isDownload,f=a?"x2"===a?2:4:void 0,!d){e.next=8;break}return e.next=5,getPdfBlobAndSave({baseGroup:r,originalWidth:s,originalHeight:l,fileImgName:o,qualityValue:i,type:c,upscaleSize:f});case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,getImgBlobAndSave({baseGroup:r,originalWidth:s,originalHeight:l,fileImgName:o,qualityValue:i,type:c,isDownload:p,upscaleSize:f});case 10:e.t0=e.sent;case 11:return g=e.t0,console.log(g),h={name:o,mimeType:c,parents:n},console.log(h),(v=new FormData).append("metadata",new Blob([JSON.stringify(h)],{type:"application/json"})),v.append("file",g),console.log(v),e.next=21,x.uploadFile(v);case 21:b=e.sent,D.driveActiveImageId=b.id;case 23:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),V=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(D),!t){e.next=5;break}e.t0=t,e.next=8;break;case 5:return e.next=7,x.getFileFields({fileId:D.driveActiveImageId,fields:"parents"});case 7:e.t0=e.sent;case 8:return n=e.t0,console.log(n),r={name:"anun",mimeType:"text/plain",parents:[n]},console.log(r),a=D.imgOptions.src,(o=new FormData).append("metadata",new Blob([JSON.stringify(r)],{type:"application/json"})),o.append("file",a),console.log(o),e.next=19,x.uploadFile(o);case 19:e.sent;case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.authUser();case 2:void 0,e.next=12;break;case 6:r=e.sent,n=r.parents,console.log("parnets",n),P(t,n),e.next=15;break;case 12:console.log(" before  deletion"),S.init(P,t),console.log("parnets",n);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){x.getImageById(e)},E=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.authUser();case 2:console.log(I),I.init(T),console.log(I);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){return confirm("Authorization required")},G=function(){console.log("useGDrive");var e=Object(c.g)(),t=Object(c.f)();Object(r.useEffect)((function(){console.log("useGDrive eff");var n=new URLSearchParams(e.search);if(!n.has("state"))return null;var r=JSON.parse(n.get("state")),a=function(e){console.log(e);var t=Object.keys(e),n=t.includes("userId"),r=t.includes("action"),a=t.includes("ids"),o=t.includes("exportIds"),i=t.includes("folderId");return n&&r&&a&&"open"===e.action?v:n&&r&&o&&"open"===e.action?b:n&&r&&i&&"create"===e.action?m:void 0}(r);console.log(a),a?Object(l.a)(u.a.mark((function e(){var n,o,i,c,s,l,p,f,g,h,b;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.init();case 2:return e.next=4,D.authUser(r.userId);case 4:if(n=e.sent,console.log(n),n){e.next=9;break}return t.replace(w),e.abrupt("return");case 9:if(a!==v){e.next=33;break}return D.openWithState=r,o=Object(d.a)(r.ids,1),i=o[0],e.next=14,x.getFileFields({fileId:i,fields:"permissions"});case 14:return c=e.sent,console.log(c),D.driveActiveImageId=i,e.next=19,x.getFileFields({fileId:i,fields:"*"});case 19:if(s=e.sent){e.next=22;break}return e.abrupt("return");case 22:return console.log(s),window.fields=s,l=s.imageMediaMetadata,p=l.width,f=l.height,e.next=27,x.getImageById(i);case 27:return g=e.sent,h=g.src,b=g.mimeType,D.imgOptions={src:h,mimeType:b,width:p,height:f},C(D.imgOptions),e.abrupt("return");case 33:if(a!==m){e.next=37;break}return D.newButtonState=r,V(r.folderId),e.abrupt("return");case 37:case"end":return e.stop()}}),e)})))():t.replace(k)}))},N=n(2),W=function(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),n=t[0],a=t[1];console.log(D);var o=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.getGrantedScopes();case 2:t=e.sent,a(t.split(" ").filter((function(e){return e.includes("auth")})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{children:[Object(N.jsx)("button",{onClick:function(){D.shareDrive()},children:"Share Drive"}),Object(N.jsx)("button",{onClick:function(){D.authUser()},children:"Authorize"}),Object(N.jsx)("button",{onClick:function(){V()},children:"upload"}),Object(N.jsx)("button",{onClick:function(){D.signInWithGoogle()},children:"signIn"}),Object(N.jsx)("button",{onClick:function(){D.signOutGoogle()},children:"signOut"}),Object(N.jsx)("button",{onClick:function(){D.revokeAccess()},children:"revoke access"}),Object(N.jsx)("button",{onClick:function(){E()},children:"pick file"}),Object(N.jsx)("button",{onClick:function(){B({})},children:"pick folder"}),Object(N.jsx)("button",{onClick:o,children:"see granted scopes"})]}),n.map((function(e){return Object(N.jsx)("p",{children:e},e)})),Object(N.jsx)("div",{children:Object(N.jsx)("canvas",{id:"myCanvas"})})]})},L=function(){return Object(N.jsx)("div",{children:"hi"})},R=function(){return Object(N.jsx)("pre",{children:"console.log('aaaaaaaaa')"})},J=function(){return console.log("b"),G(),Object(N.jsxs)("div",{children:[Object(N.jsx)(W,{}),Object(N.jsx)(R,{}),Object(N.jsxs)(c.c,{children:[Object(N.jsx)(c.a,{exact:!0,path:"/",component:L}),Object(N.jsx)(c.a,{exact:!0,path:"/code",component:R})]})]})};var z=function(){return Object(N.jsx)("div",{className:"App",children:Object(N.jsx)(i.a,{children:Object(N.jsx)(J,{})})})};o.a.render(Object(N.jsx)(z,{}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.1f274789.chunk.js.map